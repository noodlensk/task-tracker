asyncapi: 2.4.0
info:
  title: Accounting
  version: 1.0.0
  description: TODO
channels:
  tasks.assigned:
    subscribe:
      message:
        $ref: "tasks.yaml#/components/messages/taskAssigned"
  tasks.created:
    subscribe:
      message:
        $ref: "tasks.yaml#/components/messages/taskCreated"
  tasks.completed:
    subscribe:
      message:
        $ref: "tasks.yaml#/components/messages/taskCompleted"
  users.created:
    subscribe:
      message:
        $ref: 'users.yaml#/components/messages/userCreated'
  users.updated:
    subscribe:
      message:
        $ref: 'users.yaml#/components/messages/userUpdated'
  accounting.task_estimated:
    publish:
      message:
        $ref: '#/components/messages/taskEstimated'
  accounting.user_charged:
    publish:
      message:
        $ref: '#/components/messages/userCharged'
  accounting.user_payed:
    publish:
      message:
        $ref: '#/components/messages/userPayed'
components:
  messages:
    taskEstimated:
      name: TaskEstimated
      payload:
        $ref: "#/components/schemas/taskEstimated"
    userCharged:
      name: UserCharged
      payload:
        $ref: "#/components/schemas/userCharged"
    userPayed:
      name: UserPayed
      payload:
        $ref: "#/components/schemas/userPayed"
  schemas:
    taskEstimated:
      type: object
      properties:
        id:
          type: string
        assignedPrice:
          type: number
        competedPrice:
          type: number
        sentAt:
          $ref: "#/components/schemas/sentAt"
    userCharged:
      type: object
      properties:
        user_uid:
          type: string
        amount:
          type: number
        reason:
          type: string
        sentAt:
          $ref: "#/components/schemas/sentAt"
    userPayed:
      type: object
      properties:
        user_uid:
          type: string
        amount:
          type: number
        reason:
          type: string
        sentAt:
          $ref: "#/components/schemas/sentAt"
    sentAt:
      type: string
      format: date-time
      description: Date and time when the message was sent.